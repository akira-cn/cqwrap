// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

/** @license MIT License (c) copyright 2011-2013 original author or authors */

/**
 * A lightweight CommonJS Promises/A and when() implementation
 * when is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @author Brian Cavalier
 * @author John Hann
 * @version 2.1.0
 */

/*!
 * Joseph Myer's md5() algorithm wrapped in a self-invoked function to prevent
 * global namespace polution, modified to hash unicode characters as UTF-8.
 *  
 * Copyright 1999-2010, Joseph Myers, Paul Johnston, Greg Holt, Will Bond <will@wbond.net>
 * http://www.myersdaily.org/joseph/javascript/md5-text.html
 * http://pajhome.org.uk/crypt/md5
 * 
 * Released under the BSD license
 * http://www.opensource.org/licenses/bsd-license
 */

(function(e){define("cqwrap/base",["require","exports","module"],function(t,n,r){function a(e,t,n,r,s,o){return i?setTimeout(function(){cc.Director.getInstance().getScheduler().scheduleCallbackForTarget(e,t,n/1e3,r,s,o)},0):(cc.Director.getInstance().getScheduler().unscheduleCallbackForTarget(e,t),cc.Director.getInstance().getScheduler().scheduleCallbackForTarget(e,t,n/1e3,r,s,o)),u.push(t),u.length-1}function f(e,t){var n=u[t];n!=null&&(cc.Director.getInstance().getScheduler().unscheduleCallbackForTarget(e,n),u[t]=null)}function l(e){cc.Director.getInstance().getScheduler().unscheduleAllCallbacksForTarget(e)}function h(e){return Array.isArray(e)}function p(e){return typeof e=="boolean"}function d(e){return e===null}function v(e){return e==null}function m(e){return typeof e=="number"}function g(e){return typeof e=="string"}function y(e){return typeof e=="symbol"}function b(e){return e===void 0}function w(e){return E(e)&&objectToString(e)==="[object RegExp]"}function E(e){return typeof e=="object"&&e!==null}function S(e){return E(e)&&objectToString(e)==="[object Date]"}function x(e){return E(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}function T(e){return typeof e=="function"}function N(e){if(typeof e!="string")return e;var t,n,r;e=e.trim();var i=[0,0,0];if(e[0]==="#")return e=e.slice(1),e.length===3&&(e=e.replace(/(\w)/g,"$1$1")),i=e.match(/\w\w/g).map(function(e){return parseInt(e,16)}),t=cc.c3b.apply(null,i),n=cc.c4b.apply(null,i.concat([255])),r=cc.c4f(n.r/255,n.g/255,n.b/255,n.a/255),{c3b:t,c4b:n,c4f:r};if(e.slice(0,4)==="rgb(")return e=e.slice(4,-1),i=cc.strToArray(e),t=cc.c3b.apply(null,i),n=cc.c4b.apply(null,i.concat([255])),r=cc.c4f(n.r/255,n.g/255,n.b/255,n.a/255),{c3b:t,c4b:n,c4f:r};if(e.slice(0,5)==="rgba(")return e=e.slice(5,-1),i=cc.strToArray(e),t=cc.c3b.apply(null,i.slice(-1)),n=cc.c4b.apply(null,i),r=cc.c4f(n.r/255,n.g/255,n.b/255,n.a/255),{c3b:t,c4b:n,c4f:r}}e.console||(e.console={log:cc.log,error:cc.log,trace:cc.log,warn:cc.log}),cc.Assert||(cc.Assert=function(e,t){if(!e)throw new Error(t)});var i=navigator.userAgent.indexOf("Cocos2dx")<0,s=navigator.userAgent.indexOf("Android")>=0,o=navigator.userAgent.indexOf("iOS")>=0;cc.isHtml5=i,cc.isAndroid=s,cc.isIOS=o,cc.isOpenGL=o||s||cc.Browser&&cc.Browser.supportWebGL,cc.isOpenGL||(cc.TransitionCrossFade=cc.TransitionFadeBL=cc.TransitionFadeTR=cc.TransitionFade);var u=[null];cc.Node.prototype.setTimeout=function(t,n){return a(this||e,t,n||0,0,0,!1)},cc.Node.prototype.setInterval=function(t,n){return a(this||e,t,n||0,cc.REPEAT_FOREVER,0,!1)},cc.Node.prototype.clearAllTimers=function(){return l(this||e)},cc.Node.prototype.clearInterval=cc.Node.prototype.clearTimeout=function(t){return f(this||e,t)},e.setTimeout==undefined&&(e.setTimeout=cc.Node.prototype.setTimeout,e.setInterval=cc.Node.prototype.setInterval,e.clearTimeout=cc.Node.prototype.clearTimeout,e.clearInterval=cc.Node.prototype.clearInterval);if(i){var c=cc.MenuItemSprite.create;cc.MenuItemSprite.create=function(){var e=arguments[0],t=[].slice.call(arguments).map(function(t,n){return n&&t===e&&(t=null),t});return c.apply(c,t)}}cc.mixin=function(e,t,n){n=n||function(e,t){if(typeof e=="undefined")return t},n==1&&(n=function(e,t){return t});for(var r in t){var i=n(e[r],t[r],r,e,t);typeof i!="undefined"&&(e[r]=i)}return e},cc.isArray=h,cc.isBoolean=p,cc.isNull=d,cc.isNullOrUndefined=v,cc.isNumber=m,cc.isString=g,cc.isSymbol=y,cc.isUndefined=b,cc.isRegExp=w,cc.isObject=E,cc.isDate=S,cc.isError=x,cc.isFunction=T,Object.defineProperty(e,"director",{get:function(){return cc.Director.getInstance()},enumerable:!0,configurable:!1}),Object.defineProperty(e,"scene",{get:function(){return cc.Director.getInstance().getRunningScene()},enumerable:!0,configurable:!1}),cc.random=function(e,t){if(typeof e=="number")return t=t||0,0|e+Math.random()*(t-e);if(e instanceof Array){var n=e.length;if(t==null)return e[0|Math.random()*n];var r=cc.arrayShuffle(e.slice(0));return r.slice(0,t)}return Math.random()},cc.tmpl=function(e,t,n){return e=e.replace(/\{([^\{\}]*)\}/g,function(e,r){if(!r)return"";try{var i=(new Function("data","with(data){return ("+r+");}"))(t);return n?n(i,r):i}catch(s){return e}}),e},cc.arrayShuffle=function(e){for(var t=e.length-1;t>0;t--){var n=0|Math.random()*(t+1),r=e[t];e[t]=e[n],e[n]=r}return e},cc.strToArray=function(e){return e.trim().split(/\s*,\s*/).map(function(e){return parseInt(e)})},cc.color=function(e,t,n,r){if(typeof e=="string")return N(e);r=r||255;var i,s,o;return i=cc.c3b(e,t,n),s=cc.c4b(e,t,n,r),o=cc.c4f(s.r/255,s.g/255,s.b/255,s.a/255),{c3b:i,c4b:s,c4f:o}},i?(cc.Director.prototype.pauseAllActions=function(){var e=director.getActionManager();return e.pauseAllRunningActions()},cc.Director.prototype.resumeActions=function(e){var t=director.getActionManager();return t.resumeTargets(e)},cc.Director.prototype.end=function(){}):(cc.Director.prototype.pauseAllActions=function(){var e=[],t=director.getActionManager(),n=director.getActionManager().pauseAllRunningActions(),r=n.count();for(var i=0;i<r;i++){var s=n.anyObject();e.push(s),n.removeObject(s)}return e},cc.Director.prototype.resumeActions=function(e){var t=director.getActionManager();for(var n=0;n<e.length;n++)t.resumeTarget(e[n])})})})(this),define("cqwrap/events",["require","exports","module","cqwrap/base"],function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||undefined}r.EventEmitter=r,r.prototype._events=undefined,r.prototype._maxListeners=undefined,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!cc.isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,s,o;this._events||(this._events={});if(e==="error"&&!this._events.error)throw t=arguments[1],t instanceof Error?t:Error('Uncaught, unspecified "error" event.');n=this._events[e];if(cc.isUndefined(n))return!1;if(cc.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=arguments.length,i=new Array(r-1);for(s=1;s<r;s++)i[s-1]=arguments[s];n.apply(this,i)}else if(cc.isObject(n)){r=arguments.length,i=new Array(r-1);for(s=1;s<r;s++)i[s-1]=arguments[s];o=n.slice(),r=o.length;for(s=0;s<r;s++)o[s].apply(this,i)}return!0},r.prototype.addListener=function(e,t){var n;if(!cc.isFunction(t))throw TypeError("listener must be a function");this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,cc.isFunction(t.listener)?t.listener:t),this._events[e]?cc.isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t;if(cc.isObject(this._events[e])&&!this._events[e].warned){var n;cc.isUndefined(this._maxListeners)?n=r.defaultMaxListeners:n=this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!cc.isFunction(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,i,s;if(!cc.isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;n=this._events[e],i=n.length,r=-1;if(n===t||cc.isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(cc.isObject(n)){for(s=i;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;n.length===1?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[e]&&delete this._events[e],this;if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}return this.removeAllListeners("removeListener"),this._events={},this}n=this._events[e];if(cc.isFunction(n))this.removeListener(e,n);else if(Array.isArray(n))while(n.length)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return!this._events||!this._events[e]?t=[]:cc.isFunction(this._events[e])?t=[this._events[e]]:t=this._events[e].slice(),t},r.listenerCount=function(e,t){var n;return!e._events||!e._events[t]?n=0:cc.isFunction(e._events[t])?n=1:n=e._events[t].length,n},e("cqwrap/base"),cc.mixin(cc.Director.prototype,new r),n.exports={EventEmitter:r}}),function(e,t){e("cqwrap/when",[],function(){function e(e,t,n,i){return r(e).then(t,n,i)}function n(e,t){this.then=e,this.inspect=t}function r(e){return o(function(t){t(e)})}function i(t){return e(t,f)}function s(){function i(i,s,o){e.resolve=e.resolver.resolve=function(e){return n?r(e):(n=!0,i(e),t)},e.reject=e.resolver.reject=function(e){return n?r(f(e)):(n=!0,s(e),t)},e.notify=e.resolver.notify=function(e){return o(e),e}}var e,t,n;return e={promise:D,resolve:D,reject:D,notify:D,resolver:{resolve:D,reject:D,notify:D}},e.promise=t=o(i),e}function o(e){function i(e,n,i){return o(function(s,o,u){r?r.push(function(t){t.then(e,n,i).then(s,o,u)}):P(function(){t.then(e,n,i).then(s,o,u)})})}function s(){return t?t.inspect():x()}function a(e){if(!r)return;t=u(e),c(r,t),r=D}function h(e){a(f(e))}function p(e){r&&c(r,l(e))}var t,r=[];return e(a,h,p),new n(i,s)}function u(e){return e instanceof n?e:!(e===Object(e)&&"then"in e)||"act"in e?a(e):o(function(t,n,r){P(function(){try{var i=e.then;typeof i=="function"?C(i,e,t,n,r):t(a(e))}catch(s){n(s)}})})}function a(e){var t=new n(function(n){try{return typeof n=="function"?u(n(e)):t}catch(r){return f(r)}},function(){return E(e)});return t}function f(e){var t=new n(function(n,r){try{return typeof r=="function"?u(r(e)):t}catch(i){return f(i)}},function(){return S(e)});return t}function l(e){var t=new n(function(n,r,i){try{return typeof i=="function"?l(i(e)):t}catch(s){return l(s)}});return t}function c(e,t){P(function(){var n,r=0;while(n=e[r++])n(t)})}function h(e){return e&&typeof e.then=="function"}function p(t,n,r,i,s){return e(t,function(t){function u(r,i,s){function d(e){c(e)}function v(e){l(e)}var o,u,a,f,l,c,h,p;h=t.length>>>0,o=Math.max(0,Math.min(n,h)),a=[],u=h-o+1,f=[];if(!o)r(a);else{c=function(e){f.push(e),--u||(l=c=j,i(f))},l=function(e){a.push(e),--o||(l=c=j,r(a))};for(p=0;p<h;++p)p in t&&e(t[p],v,d,s)}}return o(u).then(r,i,s)})}function d(e,t,n,r){function i(e){return t?t(e[0]):e[0]}return p(e,1,i,n,r)}function v(e,t,n,r){return b(e,j).then(t,n,r)}function m(){return b(arguments,j)}function g(e){return b(e,E,S)}function y(e,t){return b(e,t)}function b(t,n,r){return e(t,function(t){function i(i,s,o){var u,a,f,l,c;f=a=t.length>>>0,u=[];if(!f){i(u);return}l=function(t,a){e(t,n,r).then(function(e){u[a]=e,--f||i(u)},s,o)};for(c=0;c<a;c++)c in t?l(t[c],c):--f}return o(i)})}function w(t,n){var r=C(N,arguments,1);return e(t,function(t){var i;return i=t.length,r[0]=function(t,r,s){return e(t,function(t){return e(r,function(e){return n(t,e,s,i)})})},T.apply(t,r)})}function E(e){return{state:"fulfilled",value:e}}function S(e){return{state:"rejected",reason:e}}function x(){return{state:"pending"}}function P(e){L.push(e)===1&&H()}function H(){k(B)}function B(){var e,t=0;while(e=L[t++])e();L=[]}function j(e){return e}e.defer=s,e.resolve=r,e.reject=i,e.join=m,e.all=v,e.map=y,e.reduce=w,e.settle=g,e.any=d,e.some=p,e.isPromise=h,e.promise=o,n.prototype={otherwise:function(e){return this.then(D,e)},ensure:function(e){function t(){return r(e())}return this.then(t,t).yield(this)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return v(t,function(t){return e.apply(D,t)})})},always:function(e,t){return this.then(e,e,t)}};var T,N,C,k,L,A,O,M,_,D;return L=[],A=t.setTimeout,k=typeof setImmediate=="function"?setImmediate.bind(t):typeof process=="object"&&process.nextTick?process.nextTick:typeof vertx=="object"?vertx.runOnLoop:function(e){A(e,0)},O=Function.prototype,M=O.call,C=O.bind?M.bind(M):function(e,t){return e.apply(t,N.call(arguments,2))},_=[],N=_.slice,T=_.reduce||function(e){var t,n,r,i,s;s=0,t=Object(this),i=t.length>>>0,n=arguments;if(n.length<=1)for(;;){if(s in t){r=t[s++];break}if(++s>=i)throw new TypeError}else r=n[1];for(;s<i;++s)s in t&&(r=e(r,t[s],s,t));return r},e})}(typeof define=="function"&&define.amd?define:function(e){typeof module!="undefined"?module.exports=e():typeof window!="undefined"&&(window.when=e())},this),define("cqwrap/native",["require","exports","module","cqwrap/when"],function(e,t,n){var r=e("cqwrap/when"),i=0,s=[];if(!global.native){var o={postMessage:function(){cc.log("native interface not found, ignored.")}};Object.defineProperty(global,"native",{get:function(){return o},enumerable:!0,configurable:!1})}Object.defineProperty(native,"onmessage",{value:function(e){var e=JSON.parse(e);if(e&&e.jsonrpc=="2.0"){var t=s[e.id];t&&t(e)}else if(e&&e.protocal=="weizoo"){var n=decodeURIComponent(e.code);n&&(new Function(n))()}},enumerable:!1,writable:!1,configurable:!1}),native.call=function(e,t){var n=r.defer();t=t||{};var o={jsonrpc:"2.0",method:e,params:t,id:i++};return s[o.id]=function(e){e.result?n.resolve(e.result):n.reject(e.error)},native.postMessage(JSON.stringify(o)),n.promise},cc.isAndroid&&(global.open=function(e){/^(http(s)?|file):\/\//.test(e)||(e="file:///android_asset/"+e),native.call("open",{url:e})},global.close=function(e){}),n.exports=native}),function(){function e(e,t){var o=e[0],u=e[1],a=e[2],f=e[3];o=n(o,u,a,f,t[0],7,-680876936),f=n(f,o,u,a,t[1],12,-389564586),a=n(a,f,o,u,t[2],17,606105819),u=n(u,a,f,o,t[3],22,-1044525330),o=n(o,u,a,f,t[4],7,-176418897),f=n(f,o,u,a,t[5],12,1200080426),a=n(a,f,o,u,t[6],17,-1473231341),u=n(u,a,f,o,t[7],22,-45705983),o=n(o,u,a,f,t[8],7,1770035416),f=n(f,o,u,a,t[9],12,-1958414417),a=n(a,f,o,u,t[10],17,-42063),u=n(u,a,f,o,t[11],22,-1990404162),o=n(o,u,a,f,t[12],7,1804603682),f=n(f,o,u,a,t[13],12,-40341101),a=n(a,f,o,u,t[14],17,-1502002290),u=n(u,a,f,o,t[15],22,1236535329),o=r(o,u,a,f,t[1],5,-165796510),f=r(f,o,u,a,t[6],9,-1069501632),a=r(a,f,o,u,t[11],14,643717713),u=r(u,a,f,o,t[0],20,-373897302),o=r(o,u,a,f,t[5],5,-701558691),f=r(f,o,u,a,t[10],9,38016083),a=r(a,f,o,u,t[15],14,-660478335),u=r(u,a,f,o,t[4],20,-405537848),o=r(o,u,a,f,t[9],5,568446438),f=r(f,o,u,a,t[14],9,-1019803690),a=r(a,f,o,u,t[3],14,-187363961),u=r(u,a,f,o,t[8],20,1163531501),o=r(o,u,a,f,t[13],5,-1444681467),f=r(f,o,u,a,t[2],9,-51403784),a=r(a,f,o,u,t[7],14,1735328473),u=r(u,a,f,o,t[12],20,-1926607734),o=i(o,u,a,f,t[5],4,-378558),f=i(f,o,u,a,t[8],11,-2022574463),a=i(a,f,o,u,t[11],16,1839030562),u=i(u,a,f,o,t[14],23,-35309556),o=i(o,u,a,f,t[1],4,-1530992060),f=i(f,o,u,a,t[4],11,1272893353),a=i(a,f,o,u,t[7],16,-155497632),u=i(u,a,f,o,t[10],23,-1094730640),o=i(o,u,a,f,t[13],4,681279174),f=i(f,o,u,a,t[0],11,-358537222),a=i(a,f,o,u,t[3],16,-722521979),u=i(u,a,f,o,t[6],23,76029189),o=i(o,u,a,f,t[9],4,-640364487),f=i(f,o,u,a,t[12],11,-421815835),a=i(a,f,o,u,t[15],16,530742520),u=i(u,a,f,o,t[2],23,-995338651),o=s(o,u,a,f,t[0],6,-198630844),f=s(f,o,u,a,t[7],10,1126891415),a=s(a,f,o,u,t[14],15,-1416354905),u=s(u,a,f,o,t[5],21,-57434055),o=s(o,u,a,f,t[12],6,1700485571),f=s(f,o,u,a,t[3],10,-1894986606),a=s(a,f,o,u,t[10],15,-1051523),u=s(u,a,f,o,t[1],21,-2054922799),o=s(o,u,a,f,t[8],6,1873313359),f=s(f,o,u,a,t[15],10,-30611744),a=s(a,f,o,u,t[6],15,-1560198380),u=s(u,a,f,o,t[13],21,1309151649),o=s(o,u,a,f,t[4],6,-145523070),f=s(f,o,u,a,t[11],10,-1120210379),a=s(a,f,o,u,t[2],15,718787259),u=s(u,a,f,o,t[9],21,-343485551),e[0]=c(o,e[0]),e[1]=c(u,e[1]),e[2]=c(a,e[2]),e[3]=c(f,e[3])}function t(e,t,n,r,i,s){return t=c(c(t,e),c(r,s)),c(t<<i|t>>>32-i,n)}function n(e,n,r,i,s,o,u){return t(n&r|~n&i,e,n,s,o,u)}function r(e,n,r,i,s,o,u){return t(n&i|r&~i,e,n,s,o,u)}function i(e,n,r,i,s,o,u){return t(n^r^i,e,n,s,o,u)}function s(e,n,r,i,s,o,u){return t(r^(n|~i),e,n,s,o,u)}function o(t){/[\x80-\xFF]/.test(t)&&(t=unescape(encodeURI(t))),txt="";var n=t.length,r=[1732584193,-271733879,-1732584194,271733878],i;for(i=64;i<=t.length;i+=64)e(r,u(t.substring(i-64,i)));t=t.substring(i-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<t.length;i++)s[i>>2]|=t.charCodeAt(i)<<(i%4<<3);s[i>>2]|=128<<(i%4<<3);if(i>55){e(r,s);for(i=0;i<16;i++)s[i]=0}return s[14]=n*8,e(r,s),r}function u(e){var t=[],n;for(n=0;n<64;n+=4)t[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);return t}function f(e){var t="",n=0;for(;n<4;n++)t+=a[e>>n*8+4&15]+a[e>>n*8&15];return t}function l(e){for(var t=0;t<e.length;t++)e[t]=f(e[t]);return e.join("")}function c(e,t){return e+t&4294967295}var a="0123456789abcdef".split("");md5=function(e){return l(o(e))};if(md5("hello")!="5d41402abc4b2a76b9719d911017c592")function c(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}}(),define("cqwrap/md5",function(){}),define("cqwrap/audio",["require","exports","module"],function(e,t,n){var r=cc.AudioEngine.getInstance(),i={effect:!0,music:!0},s={preloadEffect:function(e){r.preloadEffect(e)},preloadMusic:function(e){r.preloadMusic(e)},playEffect:function(e){i.effect&&r.playEffect(e,!1)},playMusic:function(e){i.music&&r.playMusic(e,!0),this._music=e},pauseMusic:function(){i.music&&r.pauseMusic()},resumeMusic:function(){i.music&&r.resumeMusic()},stopMusic:function(){i.music&&r.stopMusic()},isMusicPlaying:function(){return r.isMusicPlaying()},setEnable:function(e){typeof e!="object"&&(e={effect:e,music:e}),i.music==1&&e.music==0?r.stopMusic():i.music==0&&e.music==1&&this._music&&r.playMusic(this._music),i={effect:e.effect,music:e.music}}};n.exports=s}),define("cqwrap/data",["require","exports","module"],function(e,t,n){var r="weizoo",i=cc.Class.extend({ctor:function(e,t){this.name=e,this.salt=t||r},getRootKey:function(){return[this.salt,this.name].join("::")},get:function(e,t){var n=sys.localStorage.getItem(this.getRootKey())||"{}";return n=JSON.parse(n),e==null?n:n[e]!=null?n[e]:t},set:function(e,t){var n=this.get();n[e]=t,sys.localStorage.setItem(this.getRootKey(),JSON.stringify(n))}}),s=new i("gameSettings"),o=new i("userData");n.exports={SimpleStorage:i,GameSettings:s,UserData:o}}),define("cqwrap/style",["require","exports","module"],function(e,t,n){function i(e){return e.replace(/\-(\w)/ig,function(e,t){return t.toUpperCase()})}var r=cc.strToArray,s={};cc.registerTTF=function(e,t){s[e]=t};var o={anchor:{set:function(e,t){return e&&e.setAnchorPoint?(typeof t=="string"&&(t=r(t)),typeof t=="number"&&(t=[t,t]),t instanceof Array&&(t=cc.p.apply(null,t)),e.setAnchorPoint(t),!0):!1},get:function(e){if(e&&e.getAnchorPoint)return e.getAnchorPoint()}},texture:{set:function(e,t){if(t instanceof cc.Texture2D){var n=t.getContentSize();e.setTextureRect(cc.rect(0,0,n.width,n.height)),e.setTexture(t)}t=t.trim();var i=t.match(/(.*)\s*(?:rect\((.*)\))/),s=null;i&&(t=i[1].trim(),s=r(i[2]),s=cc.rect.apply(null,s));var o=t&&cc.SpriteFrameCache.getInstance().getSpriteFrame(t);if(o)return e.setDisplayFrame(o),s&&e.setTextureRect(s),!0;var u=cc.TextureCache.getInstance().addImage(t),a=e.getTextureRect().width;return a<=0?s?e.initWithTexture(u,s):e.initWithTexture(u):(s&&e.setTextureRect(s),e.setTexture(u)),!0},get:function(e){return e.getTexture()}},position:{set:function(e,t){return e&&e.setPosition?(typeof t=="string"&&(t=r(t)),t instanceof Array&&(t=cc.p.apply(null,t)),e.setPosition(t),!0):!1},get:function(e){if(e&&e.getPosition){var t=e.getPosition();return cc.p(t.x,t.y)}}},positionX:{set:function(e,t){var n=e.getPosition();return a.setStyle(e,"position",cc.p(t,n.y))},get:function(){if(node&&node.getPosition)return node.getPosition().x}},positionY:{set:function(e,t){var n=e.getPosition();return a.setStyle(e,"position",cc.p(n.x,t))},get:function(){if(node&&node.getPosition)return node.getPosition().y}},size:{set:function(e,t){return e&&e.setContentSize?(typeof t=="string"&&(t=r(t)),t instanceof Array&&(t=cc.size.apply(null,t)),e.setContentSize(t),e.setDimensions&&e.setDimensions(t),!0):!1},get:function(e){if(e&&e.getContentSize)return e.getContentSize()}},width:{set:function(e,t){var n=e.getContentSize();return a.setStyle(e,"size",cc.size(t,n.height))},get:function(e){if(e&&e.getContentSize)return e.getContentSize().width}},height:{set:function(e,t){var n=e.getContentSize();return a.setStyle(e,"size",cc.size(n.width,t))},get:function(e){if(e&&e.getContentSize)return e.getContentSize().height}},zOrder:{set:function(e,t){return e&&e.setZOrder?(e.setZOrder(t),!0):!1},get:function(e){if(e&&e.getZOrder)return e.getZOrder()}},color:{set:function(e,t){return e&&e.setColor?(t=cc.color(t).c4b,e.setColor(t),!0):!1},get:function(e){if(e&&e.getColor)return e.getColor()}},backgroundColor:{set:function(e,t){if(e){t=cc.color(t).c4b;var n=cc.LayerColor.create(t);return n.setZOrder(-1),n.setContentSize(e.getContentSize()),e.addChild(n),!0}return!1}},fontFamily:{set:function(e,t){return cc.isIOS||(t=s[t]||t),e&&e.setFontName?(e.setFontName(t),!0):!1},get:function(e){if(e&&e.getFontName)return e.getFontName()}},fontSize:{set:function(e,t){return e&&e.setFontSize?(e.setFontSize(t),!0):!1},get:function(e){if(e&&e.getFontSize)return e.getFontSize()}},textAlign:{set:function(e,t){if(e&&e.setHorizontalAlignment){var n={center:cc.TEXT_ALIGNMENT_CENTER,left:cc.TEXT_ALIGNMENT_LEFT,right:cc.TEXT_ALIGNMENT_RIGHT};return typeof t=="string"&&(t=n[t]),e.setHorizontalAlignment(t),!0}return!1},get:function(e){if(e&&e.getHorizontalAlignment)return e.getHorizontalAlignment()}},vAlign:{set:function(e,t){if(e&&e.setVerticalAlignment){var n={middle:cc.VERTICAL_TEXT_ALIGNMENT_CENTER,top:cc.VERTICAL_TEXT_ALIGNMENT_TOP,bottom:cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM};return typeof t=="string"&&(t=n[t]),e.setVerticalAlignment(t),!0}return!1},get:function(e){if(e&&e.getVerticalAlignment)return e.getVerticalAlignment()}},opacity:{set:function(e,t){return e&&e.setOpacity?(e.setOpacity(t),!0):!1},get:function(e){if(e&&e.getOpacity)return e.getOpacity()}},scale:{set:function(e,t){return e&&e.setScale?(typeof t=="string"&&(t=r(t)),t instanceof Array?e.setScale.apply(e,t):e.setScale(t),!0):!1},get:function(e){if(e&&e.getScale)return e.getScale()}},scaleX:{set:function(e,t){return e&&e.setScaleX?(e.setScaleX(t),!0):!1},get:function(e,t){if(e&&e.getScaleX)return e.getScaleX()}},scaleY:{set:function(e,t){return e&&e.setScaleY?(e.setScaleY(t),!0):!1},get:function(e,t){if(e&&e.getScaleY)return e.getScaleY()}},flipX:{set:function(e,t){return e&&e.setFlipX?(e.setFlipX(t),!0):e&&e.setFlippedX?(e.setFlippedX(t),!0):!1},get:function(e,t){if(e&&e.getFlipX)return e.getFlipX();if(e&&e.getFlippedX)return e.getFlippedX()}},flipY:{set:function(e,t){return e&&e.setFlipY?(e.setFlipY(t),!0):e&&e.setFlippedY?(e.setFlippedY(t),!0):!1},get:function(e,t){if(e&&e.getFlipY)return e.getFlipY();if(e&&e.getFlippedY)return e.getFlippedY()}},rotate:{set:function(e,t){if(e&&e.setRotation)return e.setRotation(t),!0},get:function(e){if(e&&e.getRotation)return e.getRotation()}}},u={zIndex:"zOrder",xy:"position",x:"positionX",y:"positionY",wh:"size",w:"width",h:"height"},a={setStyle:function(e,t,n){if(typeof t!="object"){t=i(t),t=u[t]||t;if(!o[t]){var s=e[i("set-"+t)];if(s)try{return s.call(e,n),!0}catch(a){return!1}return!1}return o[t].set(e,n)}for(var r in t)this.setStyle(e,r,t[r])},getStyle:function(e,t){t=i(t),t=u[t]||t;if(!o[t]){var n=e[i("get-"+t)];if(n)try{return n.call(e)}catch(r){return null}return null}return o[t].get(e)}};cc.Node.prototype.setStyle=function(e,t){a.setStyle(this,e,t)},cc.Node.prototype.getStyle=function(e,t){return a.getStyle(this,e)},n.exports={StyleManager:a}}),define("cqwrap/nodes",["require","exports","module"],function(e,t,n){var r=cc.Node.extend({ctor:function(){this._super(),this.init.apply(this,arguments),cc.associateWithNative(this,cc.Sprite)},init:function(){this._super()}});n.exports={BaseNode:r}}),define("cqwrap/labels",["require","exports","module","cqwrap/sprites"],function(e,t,n){var r=e("cqwrap/sprites").BaseSprite;cc.LabelTTF.extend=cc.Sprite.extend;var i=cc.LabelTTF.extend({ctor:function(e){this._super.apply(this,arguments),this.init.apply(this,arguments),cc.associateWithNative(this,cc.LabelTTF)},init:function(e){this.initWithString(e,"Arial",16),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0)}});n.exports={BaseLabel:i}}),define("cqwrap/sprites",["require","exports","module","cqwrap/labels"],function(e,t,n){var r=cc.Sprite.extend({ctor:function(){this._super(),this.init.apply(this,arguments),cc.associateWithNative(this,cc.Sprite)},init:function(e,t){if(e instanceof cc.Texture2D)this.initWithTexture(e,t);else{var n=e&&cc.SpriteFrameCache.getInstance().getSpriteFrame(e);n?(this.initWithSpriteFrame(n),t&&this.setTextureRect(t)):this._super.apply(this,arguments)}this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0)}});cc.createSprite=function(t,n){typeof t=="object"&&!(t instanceof cc.Sprite)&&n==null&&(n=t,t=new r),n=n||{};if(typeof t=="string")if(t[0]==="@"){var i=e("cqwrap/labels").BaseLabel;t=new i(t.slice(1))}else/\.plist$/.test(t)?t=cc.ParticleSystem.create(t):t=new r(t);return t.setStyle(n),t},n.exports={BaseSprite:r}}),define("cqwrap/layers",["require","exports","module","cqwrap/events","cqwrap/sprites","cqwrap/when"],function(e,t,n){function a(e,t,n){var r=t.getLocation(),i=e._touchTargets;t.returnValue=!0;for(var s=0;s<i.length;s++){var o=i[s],u=o.convertToNodeSpace(r),a=o.getContentSize(),f=cc.rect(0,0,a.width,a.height);if(cc.rectContainsPoint(f,u))return t.returnValue=!0,t.preventDefault=function(){t.returnValue=!1},n==="touchstart"&&(e._touchedTarget=o,e._currentTarget=o),n==="touchmove"&&o!==e._currentTarget&&(e._currentTarget&&e._currentTarget.emit("touchleave",t,e._currentTarget,e),o.emit("touchenter",t,o,e),e._currentTarget=o),e._touchedTarget&&n==="touchmove"&&o!==e._touchedTarget&&(e._touchedTarget.emit("touchend",t,e._touchedTarget,e),e._moved=!0,delete e._touchedTarget),o.emit(n,t,o,e),t.returnValue}return e._touchedTarget&&(n==="touchmove"||n==="touchend")&&(e._touchedTarget.emit("touchend",t,e._touchedTarget,e),e._currentTarget&&(e._currentTarget.emit("touchleave",t,e._currentTarget,e),delete e._currentTarget),e._moved=!0,delete e._touchedTarget),!1}var r=e("cqwrap/events").EventEmitter,i=e("cqwrap/sprites").BaseSprite,s=e("cqwrap/when"),o=cc.Layer.extend({ctor:function(){this._super(),this._contextDefer=s.defer(),this.init.apply(this,arguments),cc.associateWithNative(this,cc.Layer)},getContext:function(){var e=this._contextDefer;return e.promise},publish:function(){var e=[].slice.apply(arguments);this.getContext().then(function(t){t.__pubsubEmitter||(t.__pubsubEmitter=new r),t.setTimeout(function(){t.__pubsubEmitter.emit.apply(t,e)},0)})},subscribe:function(){var e=[].slice.apply(arguments);this.getContext().then(function(t){t.__pubsubEmitter||(t.__pubsubEmitter=new r),t.__pubsubEmitter.on.apply(t,e)})},unsubscribe:function(){var e=[].slice.apply(arguments);this.getContext().then(function(t){t.__pubsubEmitter||(t.__pubsubEmitter=new r),t.__pubsubEmitter.removeListener.apply(t,e)})},onEnter:function(){this._super(),this._contextDefer.resolve(this.getParent())},onExit:function(){this._super(),this.clearAllTimers()}}),u=o.extend({init:function(e){this._super();var t=cc.color(e);if(t){var n=cc.LayerColor.create(t.c4b);this.addChild(n)}else{var r=director.getWinSize(),s=new i(e);s.setPosition(cc.p(r.width/2,r.height/2)),this.addChild(s)}return!0}}),f=o.extend({init:function(){this._super(),this._touchTargets=[],this._batches={},this._clickAndMove=!0,this._autoDelegate=!0,this._retainNodes=[],this.backClicked&&this.setKeypadEnabled&&this.setKeypadEnabled(!0)},onEnter:function(){this._super(),this.registerDelegate();if(this.getParent()instanceof cc.Scene){var e=director.offsetY||0;this.setPosition(cc.p(0,e))}if(this.backClicked&&typeof history!="undefined"){var t=this;history.pushState({},"");var n=function(e){t.backClicked()};this._pushState=n,window.addEventListener("popstate",n)}},retainNode:function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];this._retainNodes.indexOf(t)<0&&(t.retain(),this._retainNodes.push(t))}},onExit:function(){for(var e=0;e<this._retainNodes.length;e++)this._retainNodes[e].release();this.unregisterDelegate(),this.backClicked&&typeof history!="undefined"&&this._pushState&&(window.removeEventListener("popstate",this._pushState),this._pushState=null),this._batches={},this._super()},addChild:function(e){if(cc.isArray(e)){var t=[].slice.call(arguments);for(var n=0;n<e.length;n++)t[0]=e[n],this.addChild.apply(this,t)}else this._super.apply(this,arguments),this._autoDelegate&&e.on&&this.delegate(e)},addChildToBatch:function(e,t){if(cc.isArray(e)){var n=[].slice.call(arguments);for(var r=0;r<e.length;r++)n[0]=e[r],this.addChildToBatch.apply(this,n)}else{var i;this._batches[t]?i=this._batches[t]:(i=cc.SpriteBatchNode.create(t),this._batches[t]=i,i.setZOrder(10),f.prototype.addChild.call(this,i)),i.addChild(e),this._autoDelegate&&e.on&&this.delegate(e)}},setTouchRect:function(e){this._touchRect=e},setClickAndMove:function(e){this._clickAndMove=e},setAutoDelegate:function(e){this._autoDelegate=e},addSprite:function(e,t,n){var n=n||this;e=cc.createSprite(e,t),n.addChild(e)},delegate:function(e,t,n){this._touchTargets.indexOf(e)<0&&(e.on||cc.mixin(e,new r),this._touchTargets.unshift(e),this._touchTargets.sort(function(e,t){return t.getZOrder()-e.getZOrder()})),t&&e.on(t,n)},undelegate:function(e,t){var n=this._touchTargets.indexOf(e);n>=0&&(t?e.removeAllListeners(t):(this._touchTargets.splice(n,1),e.removeAllListeners()))},getAbsoulteZOrder:function(){var e=this,t=0;while(e)t+=e.getZOrder(),e=e.getParent();return t},registerDelegate:function(){cc.registerTargetedDelegate(parseInt(-this.getZOrder()),!0,this)},unregisterDelegate:function(){cc.unregisterTouchDelegate(this)},onTouchBegan:function(e,t){return this._touchRect&&!cc.rectContainsPoint(this._touchRect,e.getLocation())?!1:(this._touchPoint=e.getLocation(),a(this,e,"touchstart"))},onTouchMoved:function(e,t){var n=e.getLocation(),r=director.getWinSize();return!this._clickAndMove&&(Math.abs(this._touchPoint.x-n.x)>=r.width/30||Math.abs(this._touchPoint.y-n.y)>=r.height/30)&&(this._moved=!0),a(this,e,"touchmove")},onTouchEnded:function(e,t){return a(this,e,"touchend"),this._moved||a(this,e,"click"),this._moved=!1,e.returnValue},onTouchCancelled:function(e,t){return a(this,e,"touchcancel")}}),l=f.extend({init:function(e){e=e||128,this._super();var t=cc.LayerColor.create(cc.c4b(0,0,0,e));this.addChild(t)},onEnter:function(){this._super(),this.getParent().delegate(this)},onExit:function(){this.getParent().undelegate(this),this._super()}}),c=f.extend({init:function(e,t){this._super();var n=[new l(t),new l(t),new l(t),new l(t)];this.addChild(n),this._masks=n,this.setRect(e)},setRect:function(e){var t=this._masks,n=director.getWinSize();t[0].setPosition(cc.p(e.x-n.width,e.y)),t[1].setPosition(cc.p(e.x,e.y+e.height)),t[2].setPosition(cc.p(e.x+e.width,e.y+e.height-n.height)),t[3].setPosition(cc.p(e.x+e.width-n.width,e.y-n.height))}});n.exports={BaseLayer:o,BgLayer:u,GameLayer:f,MaskLayer:l,MaskWithRectLayer:c}}),define("cqwrap/tiles",["require","exports","module","cqwrap/layers"],function(e,t,n){var r=e("cqwrap/layers").GameLayer,i=r.extend({init:function(e,t){this._super(),t=t||e,this.width=e,this.height=t,this.setAutoDelegate(!1)},addChild:function(e,t,n){this.setXY(e,t,n),this._super(e)},addChildToBatch:function(e,t,n,r){this.setXY(e,t,n),this._super(e,r)},setXY:function(e,t,n){if(!e._pos){var r=e.getStyle("xy");e._pos=cc.p(r.x,r.y)}e.setStyle({xy:[t*this.width+e._pos.x,n*this.height+e._pos.y]})},setPoint:function(e,t){this.setXY(e,t.x,t.y)},locationToPoint:function(e){var t=this.getPosition(),n=this.getScaleX(),r=this.getScaleY(),i=0|(e.x-t.x)/(this.width*n),s=0|(e.y-t.y)/(this.height*r);return cc.p(i,s)},pointToLocation:function(e,t){t=t||cc.p(.5,.5);var n=this.getPosition(),r=this.getScaleX(),i=this.getScaleY();return cc.p(n.x+(e.x+t.x)*this.width*r,n.y+(e.y+t.y)*this.height*i)}});n.exports={TileNode:i}}),define("cqwrap/fonts",["require","exports","module","cqwrap/sprites"],function(e,t,n){var r=e("cqwrap/sprites").BaseSprite,i=r.extend({init:function(e,t){t=t||{},this._super(),this._prefix=t.prefix||"",this.setString(e),this.setStyle(t)},setPrefix:function(e){this._prefix=e},setString:function(e){e=e.toString();var t=this.getChildren()||[];for(var n=0;n<t.length;n++)t[n].removeFromParent(!0);var r=0,i=0;for(var n=0;n<e.length;n++){var s=this._prefix+e[n]+".png",o=cc.createSprite(s,{anchor:[0,0],xy:[r,0]});this.addChild(o);var u=o.getContentSize();r+=u.width,heigth=Math.max(u.height,i)}this.setContentSize(r,heigth)}});n.exports={LabelFontFC:i}}),define("cqwrap/animate",["require","exports","module","cqwrap/sprites"],function(e,t,n){function u(){}var r={},i=e("cqwrap/sprites").BaseSprite,s=function(e){var t=cc.SpriteFrameCache.getInstance(),n=[],r=0;do{var i=e.replace("%d",r),s=t.getSpriteFrame(i);if(!s)break;n.push(s)}while(++r);return n};r.createAnimFromPng=function(e,t){var n=s(e),r=cc.Animation.create(n,t);return cc.Animate.create(r)},r.createRFAnimFromPng=function(e,t){return cc.RepeatForever.create(r.createAnimFromPng(e,t))};var o=i.extend({init:function(e){return this._super(),this.img=e,this.animate=null,!0},animate:function(e,t){if(!this.animate){var n=this.img;/%d/.test(this.img)||(n=this.img.replace(/\./,"%d."));var i=t?"createRFAnimFromPng":"createAnimFromPng";this.animate=r[i](n,e)}this.runAction(this.animate)}});cc.mixin(u.prototype,{getActions:function(){return this._animSeq=this._animSeq||[],this._animSeq},addAction:function(e,t,n,r){var i;if(e instanceof cc.Action)r=n,n=t,i=[e];else{for(var s=t.length-1;s>=0;s--)if(t[s]!==undefined)break;t.length=s+1,i=[e.create.apply(e,t)]}if(n){var o=[].slice.call(arguments,3);for(var s=o.length-1;s>=0;s--)if(o[s]!==undefined)break;o.length=s+1,i[0]=n.create.apply(n,[i[0]].concat(o))}var u=this.getActions();return u.push.apply(u,i),this},clearActions:function(){return this.getActions().length=0,this},delay:function(e){return this.addAction(cc.DelayTime,[e])},repeat:function(e,t){e=e||9999999,t=t||0;var n=this.getActions();if(n.length>0){var r=cc.Sequence.create.apply(cc.Sequence,n.slice(-t));r=cc.Repeat.create(r,e),t==0?n.length=0:n.length=n.length-t,n.push(r)}return this},reverse:function(){var e=this.getActions();if(e.length>0){var t=e[e.length-1];e.push(t.reverse())}return this},reverseAll:function(){var e=this.getActions();if(e.length>0){var t=cc.Sequence.create.apply(cc.Sequence,e);e.push(t.reverse())}return this},then:function(e){return e=cc.CallFunc.create(e,this),this.getActions().push(e),this},animate:function(e){var t=[].slice.call(arguments,1);if(/%d/.test(t[0]))t=s(t[0]);else{var n=cc.SpriteFrameCache.getInstance();t=t.map(function(e){return n.getSpriteFrame(e)})}var r=cc.Animation.create(t,e/t.length);return this.getActions().push(cc.Animate.create(r)),this},bezierBy:function(e,t,n,r){return this.addAction(cc.BezierBy,[e,t],n,r)},bezierTo:function(e,t,n,r){return this.addAction(cc.BezierTo,[e,t],n,r)},blink:function(e,t,n,r){return this.addAction(cc.Blink,[e,t],n,r)},fadeIn:function(e,t,n){return this.addAction(cc.FadeIn,[e],t,n)},fadeOut:function(e,t,n){return this.addAction(cc.FadeOut,[e],t,n)},fadeTo:function(e,t,n,r){return this.addAction(cc.FadeTo,[e,t],n,r)},jumpBy:function(e,t,n,r,i,s){return this.addAction(cc.JumpBy,[e,t,n,r||1],i,s)},jumpTo:function(e,t,n,r,i,s){return this.addAction(cc.JumpTo,[e,t,n,r||1],i,s)},moveBy:function(e,t,n,r){return this.addAction(cc.MoveBy,[e,t],n,r)},moveTo:function(e,t,n,r){return this.addAction(cc.MoveTo,[e,t],n,r)},rotateBy:function(e,t,n,r,i){return this.addAction(cc.RotateBy,[e,t,n],r,i)},rotateTo:function(e,t,n,r,i){return this.addAction(cc.RotateTo,[e,t,n],r,i)},scaleBy:function(e,t,n,r,i){return this.addAction(cc.ScaleBy,[e,t,n],r,i)},scaleTo:function(e,t,n,r,i){return this.addAction(cc.ScaleTo,[e,t,n],r,i)},skewBy:function(e,t,n,r,i){return this.addAction(cc.SkewBy,[e,t,n],r,i)},skewTo:function(e,t,n,r,i){return this.addAction(cc.SkewTo,[e,t,n],r,i)},tineBy:function(e,t,n,r,i,s){return this.addAction(cc.TineBy,[e,t,n,r],i,s)},tineTo:function(e,t,n,r,i,s){return this.addAction(cc.TineTo,[e,t,n,r],i,s)}}),cc.Node.prototype.act=function(e){return e?(e instanceof u&&e.getActions().length>0&&(e=cc.Sequence.create.apply(cc.Sequence,e.getActions())),this.runAction(e)):this.getActions().length>0&&(e=cc.Sequence.create.apply(cc.Sequence,this.getActions()),this.runAction(e),this.clearActions()),this},cc.mixin(cc.Node.prototype,new u),n.exports={AnimationTool:r,FrameAnimSprite:o,AnimationTask:u}}),define("cqwrap/scenes",["require","exports","module","cqwrap/layers","cqwrap/audio","cqwrap/when"],function(e,t,n){function f(e,t,n){t(e);if(e.length<=0)return;setTimeout(function(){f(e.slice(1),t,n)},n)}var r=e("cqwrap/layers"),i=r.BaseLayer,s=r.BgLayer,o=e("cqwrap/audio"),u=e("cqwrap/when"),a=cc.Scene.extend({ctor:function(){this._super(),this._autoReload=!1,this.init.apply(this,arguments),cc.associateWithNative(this,cc.Scene)},reload:function(){var e=new this.constructor;director.replaceScene(e)},onEnter:function(){this._super(),this._autoReload&&this._needReload&&this.reload()},onExit:function(){this._autoReload&&(this._needReload=!0),this._super()},setAutoReload:function(e){this._autoReload=e}}),l=i.extend({init:function(e,t,n,r){function a(){var e=u.defer();return setTimeout(function(){f(t,function(n){i.getParent().onProgressChange((t.length-n.length)/s),n.length<=0?e.resolve():o.preloadEffect(n[0])},r)},r),e.promise}function l(){var e=u.defer();return setTimeout(function(){f(n,function(r){i.getParent().onProgressChange((t.length+n.length-r.length)/s),r.length<=0?e.resolve():o.preloadMusic(r[0])},r)},r),e.promise}function c(){var t=u.defer();return setTimeout(function(){var n=cc.SpriteFrameCache.getInstance();f(e,function(e){i.getParent().onProgressChange(1-e.length/s),e.length<=0?setTimeout(function(){t.resolve()},r):n.addSpriteFrames(e[0][0],e[0][1])},r)},r),t.promise}this._super();var i=this;t=t||[],n=n||[],r=r||10;var s=e.length+t.length+n.length;a().then(function(){return l()}).then(function(){return c()}).then(function(){i.getParent().onLoaded()}),this.setKeypadEnabled&&this.setKeypadEnabled(!0)},backClicked:function(){this.getParent().backClicked()}}),c=a.extend({init:function(e,t,n,r){this._super();var i=new l(e,t,n,r);this.addChild(i)},onProgressChange:function(){},onLoaded:function(){},backClicked:function(){director.end()}});n.exports={BaseScene:a,LoadingScene:c}}),define("cqwrap/buttons",["require","exports","module","cqwrap/sprites","cqwrap/events"],function(e,t,n){var r=e("cqwrap/sprites").BaseSprite,i=e("cqwrap/events").EventEmitter,s=r.extend({init:function(e,t,n){function u(){s.setAnchorPoint(cc.p(0,0)),s.setPosition(cc.p(0,0)),r.addChild(s),r.setContentSize(s.getContentSize())}var r=this,s=this;this.enabled=!0,typeof t=="function"&&(n=t,t="click"),typeof e=="string"?(this._super(e),e=null):typeof e!="object"||e instanceof cc.Sprite?(s=e,this._super()):(this._super(e.texture),delete e.texture),cc.mixin(this,new i);var o=!1;n&&(this.on("touchstart",function(){if(!r.enabled||o)return;if(!r.activated){var e=r.getScaleY();r.setScale(e*.95),r.activated=!0}}),this.on("touchend",function(){if(r.activated){var e=r.getScaleY();r.setScale(e/.95),r.activated=!1}}),this.on(t,function(){if(!r.enabled||o)return;n.apply(this,arguments),o=!0,setTimeout(function(){o=!1},300)})),s!=this&&u(),e&&this.setStyle(e),this.setContentSprite=function(e){s!=r&&s.removeFromParent(!0),s=e,u()},this.getContentSprite=function(){return s},this.isEnabled=function(){return this.enabled&&n!=null}}});n.exports={Button:s}}),define("cqwrap/transitions",["require","exports","module","cqwrap/sprites"],function(e,t,n){var r=e("cqwrap/sprites").BaseSprite,i={create:function(e,t,n){if(t instanceof r){n=n||255,t.setOpacity(0);var i=cc.FadeTo.create(e,n);return t.runAction(i),t}return cc.TransitionFade.create(e,t,n)}};n.exports={TransitionFade:i}}),define("cqwrap/scroll",["require","exports","module","cqwrap/layers","cqwrap/events"],function(e,t,n){var r=e("cqwrap/layers").GameLayer,i=e("cqwrap/events").EventEmitter,s=r.extend({onEnter:function(){this._super(),this._touchRect||this.setTouchRect(this.getParent().getBoundingBox()),this.getParent().setTouchPriority(this.getTouchPriority()-1)}}),o=cc.Layer.extend({ctor:function(){this._super(),this.init.apply(this,arguments),cc.associateWithNative(this,cc.Layer),cc.mixin(this,new i)},onEnter:function(){this._super(),cc.registerTargetedDelegate(-999999,!1,this)},onExit:function(){cc.unregisterTouchDelegate(this),this._super()},onTouchBegan:function(e,t){return this.emit("beforescroll",e,t),!0},onTouchMoved:function(e,t){return this.emit("scroll",e,t),!0},onTouchEnded:function(e,t){return this.emit("afterscroll",e,t),!0}}),u=cc.ScrollView.extend({ctor:function(e,t){this._super.apply(this,arguments),this.init.apply(this,arguments),cc.associateWithNative(this,cc.ScrollView)},init:function(e,t){var n=new s;n.setAnchorPoint(cc.p(0,0)),n.setPosition(cc.p(0,0)),n.setContentSize(t),n.setClickAndMove(!1),this.initWithViewSize(e,n),this.getContentLayer=function(){return n}}}),a=u.extend({init:function(e,t){this._super(e,t);var n=this.getContentLayer(),r=new o;this.addChild(r),this._touchCaptureLayer=r;var i=this,s,u,a;r.on("beforescroll",function(e,t){n.stopAllActions(),a=i.getContentOffset()}),r.on("scroll",function(e,t){var n=Date.now();if(!s||n-s>500)u=i.getContentOffset(),s=Date.now()}),r.on("afterscroll",function(e,t){if(u){var r=i.getContentOffset(),o=Date.now()-s,a=cc.p((r.x-u.x)/o,(r.y-u.y)/o),f=500,l=i.minContainerOffset(),c=i.maxContainerOffset(),h=cc.p(.5*a.x*f,.5*a.y*f);h=cc.pAdd(r,h);if(h.x<l.x||h.y<l.y)return;if(h.x>c.x||h.y>c.x)return;n.moveTo(f/1e3,h,cc.EaseOut,2).act()}})}}),f=u.extend({init:function(e,t,n){arguments.length<=2&&(n=t,t=e.width);var s=.5*(e.width-t);this._offsetX=s;var u=cc.size(t*n+2*s,e.height);this._super(e,u),cc.mixin(this,new i),this.on("touchstart",function(e){e.preventDefault()}),this.setStyle("direction",cc.SCROLLVIEW_DIRECTION_HORIZONTAL),this._pagewidth=t;var a=this.getContentLayer();for(var f=0;f<n;f++){var l=new r;l.setStyle({xy:[s+t*f,0],tag:f,size:[t,e.height]}),cc.isHtml5&&l.setStyle("zOrder",1),l.setClickAndMove(!1),a.addChild(l)}var c=new o;this.addChild(c);var h=this,p,d,v,m;c.on("beforescroll",function(e,t){a.stopAllActions(),m=h.getPage(),v=h.getContentOffset()}),c.on("scroll",function(e,t){var n=Date.now();if(!p||n-p>500)d=h.getContentOffset(),p=Date.now()}),c.on("afterscroll",function(e,t){if(d){var n=h.getContentOffset(),r=Date.now()-p,i=h.minContainerOffset(),s=h.maxContainerOffset();if(n.x<i.x){h.setPage(h.getMaxPage(),-1);return}if(n.x>s.x){h.setPage(0,-1);return}var o=cc.p((n.x-d.x)/r,(n.y-d.y)/r);Math.max(n.x-v.x,n.y-v.y)<15&&(o=0);if(Math.abs(o.x)>.3){var u=500;if(o.x>0){var a=Math.max(0,m-1);h.setPage(a,.2)}else{var a=Math.min(h.getMaxPage(),m+1);h.setPage(a,.2)}}else h.setPage(h.getPage(),.2)}else h.setPage(h.getPage(),.2)}),this._page=null},setPage:function(e,t){var n=this._page;n!==e&&this.emit("change",e,n),t=t||0;if(t>=0){var r=this,i=cc.p(-this._pagewidth*e,0),s=this.getContentLayer();s.stopAllActions(),s.moveTo(t,i).then(function(){s.moveTo(t,i).act()}).act()}this._page=e},getPage:function(){var e=this.getContentOffset().x;return Math.min(Math.round(-e/this._pagewidth),this.getMaxPage())},getPageLayer:function(e){return this.getContentLayer().getChildByTag(e)},getMaxPage:function(){var e=this.minContainerOffset().x;return Math.round(-e/this._pagewidth)}});a.create=function(e,t){return new a(e,t)},n.exports={ScrollView:a,PageView:f}}),define("cqwrap/physics",["require","exports","module","cqwrap/sprites","cqwrap/layers"],function(e,t,n){if(typeof cp=="undefined"){cc.log("chipmunk not available!");return}var r=e("cqwrap/sprites").BaseSprite,i=e("cqwrap/layers").GameLayer;cc.RADIANS_TO_DEGREES||(cc.RADIANS_TO_DEGREES=function(e){return e*180/Math.PI}),cc.DEGREES_TO_RADIANS||(cc.DEGREES_TO_RADIANS=function(e){return e*Math.PI/180});var s=new cp.Space;s.iterations=5,s.gravity=cp.v(0,-750);var o=r.extend({init:function(e,t,n,r,i){this._super(e),n=n||5;var o=s.addBody(new cp.Body(n,cp.momentForBox(n,this.getContentSize().width,this.getContentSize().height)));o.setPos(cp.v(t.x,t.y));var u=s.addShape(new cp.BoxShape(o,this.getContentSize().width,this.getContentSize().height));u.setElasticity(r||.2),u.setFriction(i||.8),this.body=o,this.shape=u,this.scheduleUpdate()},update:function(e){cc.Assert(this.body,"no body?");var t=this.body.p;this.setPosition(t.x,t.y),this.setRotation(cc.RADIANS_TO_DEGREES(-1*this.body.a)),this._super(e)}}),u=i.extend({init:function(){this._super(),this.scheduleUpdate()},update:function(e){s.step(e)}});n.exports={CPSprite:o,CPLayer:u,Space:s}}),define("cqwrap/index",["require","exports","module","cqwrap/base","cqwrap/events","cqwrap/when","cqwrap/native","cqwrap/md5","cqwrap/audio","cqwrap/data","cqwrap/style","cqwrap/nodes","cqwrap/tiles","cqwrap/sprites","cqwrap/fonts","cqwrap/animate","cqwrap/labels","cqwrap/scenes","cqwrap/layers","cqwrap/buttons","cqwrap/transitions","cqwrap/scroll","cqwrap/physics"],function(e,t,n){e("cqwrap/base"),e("cqwrap/events"),e("cqwrap/when"),e("cqwrap/native"),global.md5||e("cqwrap/md5"),e("cqwrap/audio"),e("cqwrap/data"),e("cqwrap/style"),e("cqwrap/nodes"),e("cqwrap/tiles"),e("cqwrap/sprites"),e("cqwrap/fonts"),e("cqwrap/animate"),e("cqwrap/labels"),e("cqwrap/scenes"),e("cqwrap/layers"),e("cqwrap/buttons"),e("cqwrap/transitions"),e("cqwrap/scroll"),cc.PhysicsDebugNode&&typeof cp!="undefined"&&e("cqwrap/physics")});